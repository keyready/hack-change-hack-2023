"use strict";(self.webpackChunkhack_change_2023_client=self.webpackChunkhack_change_2023_client||[]).push([[782],{6056:(e,t,n)=>{n.d(t,{I:()=>w});var r=n(4942),o=n(4925),c=n(7294),a=n(3379),s=n.n(a),u=n(7795),i=n.n(u),l=n(569),f=n.n(l),d=n(3565),p=n.n(d),v=n(9216),S=n.n(v),b=n(4589),h=n.n(b),E=n(6408),O={};O.styleTagTransform=h(),O.setAttributes=p(),O.insert=f().bind(null,"head"),O.domAPI=i(),O.insertStyleElement=S(),s()(E.Z,O);const y=E.Z&&E.Z.locals?E.Z.locals:void 0;var _=n(5893),g=["value","onChange","type","autoFocus","readonly"];function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var w=(0,c.memo)((function(e){var t=(0,c.useRef)(null),n=e.value,a=e.onChange,s=e.type,u=void 0===s?"text":s,i=e.autoFocus,l=e.readonly,f=(0,o.Z)(e,g);return(0,c.useEffect)((function(){var e;i&&(null===(e=t.current)||void 0===e||e.focus())}),[i]),(0,_.jsx)("input",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({ref:t,value:n||"",onChange:function(e){null==a||a(e.target.value)},className:y.Input,type:u,readOnly:l},f))}))},2782:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var r=n(4942),o=n(2982),c=n(885),a=n(3007),s=n(9330),u=n(7294),i=n(7676),l=n(3329),f=n(9250),d=n(9400),p=n(6056),v=n(9319),S=n(8465),b=n(3379),h=n.n(b),E=n(7795),O=n.n(E),y=n(569),_=n.n(y),g=n(3565),T=n.n(g),w=n(9216),N=n.n(w),m=n(4589),R=n.n(m),I=n(3548),C={};C.styleTagTransform=R(),C.setAttributes=T(),C.insert=_().bind(null,"head"),C.domAPI=O(),C.insertStyleElement=N(),h()(I.Z,C);const k=I.Z&&I.Z.locals?I.Z.locals:void 0;var P=n(5893);const A=(0,u.memo)((function(e){var t=e.className;(0,u.useEffect)((function(){document.title="ChatPage"}),[]);var n=(0,v.v9)(S.Ms),b=(0,f.UO)().roomId,h=(0,u.useState)("ws://localhost:5000"),E=(0,c.Z)(h,1)[0],O=(0,u.useState)([]),y=(0,c.Z)(O,2),_=y[0],g=y[1],T=(0,u.useState)(""),w=(0,c.Z)(T,2),N=w[0],m=w[1],R=(0,i.ZP)(E),I=R.sendMessage,C=R.lastMessage;(0,u.useEffect)((function(){if(null!==C){var e=JSON.parse(C.data);e.room===b&&g((function(t){return[e].concat((0,o.Z)(t))}))}}),[C,b]);var A=(0,u.useCallback)((function(e){e.preventDefault();var t=JSON.stringify({type:"message",room:b,username:n,message:N,createdAt:new Date});I(t),m("")}),[N,b,I,n]);return(0,P.jsxs)(s.T,{className:(0,a.A)(k.ChatPage,{},[t]),children:[(0,P.jsxs)("h1",{children:["Комната: ",b," "]}),(0,P.jsxs)(l.g,{maxW:!0,gap:"32",children:[(0,P.jsx)(l.U,{maxW:!0,gap:"16",children:(0,P.jsxs)("form",{onSubmit:A,children:[(0,P.jsx)(p.I,{value:N,onChange:m}),(0,P.jsx)(d.z,{type:"submit",children:"Отправить"})]})}),(0,P.jsx)(l.g,{maxW:!0,gap:"32",children:_.length&&_.map((function(e,t){var o;return(0,P.jsx)("div",{className:(0,a.A)(k.messageCard,(o={},(0,r.Z)(o,k.ownMessage,n===e.username),(0,r.Z)(o,k.connected,"connection"===e.type),(0,r.Z)(o,k.disconnected,"disconnection"===e.type),o)),children:(0,P.jsxs)(l.U,{maxW:!0,justify:"between",children:[(0,P.jsxs)("p",{children:[e.username,"@ ",e.message]}),(0,P.jsx)("p",{children:new Date(e.createdAt).toLocaleTimeString()})]})},t)}))})]})]})}))},3548:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(8081),o=n.n(r),c=n(3645),a=n.n(c)()(o());a.push([e.id,".f9633{width:100%;padding:20px;border-radius:10px;outline:2px solid #82dbf7}.c8446{background:rgba(130,219,247,.23)}.eeaaa{background:rgba(95,252,73,.42);text-align:center}.bf189{background:rgba(254,12,12,.42);text-align:center}",""]),a.locals={messageCard:"f9633",ownMessage:"c8446",connected:"eeaaa",disconnected:"bf189"};const s=a},6408:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(8081),o=n.n(r),c=n(3645),a=n.n(c)()(o());a.push([e.id,".d3816{width:100%;padding:5px 10px;border:none;color:inherit;background:rgba(0,0,0,0);font:var(--font-m);transition:200ms;margin-bottom:5px;border-bottom:2px solid var(--card-bg);outline:none}.d3816:active,.d3816:focus{border-bottom:2px solid var(--inverted-bg-color)}",""]),a.locals={Input:"d3816"};const s=a},7676:(e,t,n)=>{t.ZP=void 0;var r=n(1835);Object.defineProperty(t,"ZP",{enumerable:!0,get:function(){return r.useWebSocket}});n(6548),n(1581),n(9448),n(9885)},3682:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.attachListeners=void 0;var o=n(1787),c=n(4203),a=n(1581),s=n(9885);t.attachListeners=function(e,t,n,u,i,l){var f,d,p,v=t.setLastMessage,S=t.setReadyState;return n.current.fromSocketIO&&(f=(0,o.setUpSocketIOPing)(l)),function(e,t,n){var r;if(t.current.heartbeat&&e instanceof WebSocket){var o="boolean"==typeof t.current.heartbeat?void 0:t.current.heartbeat;r=(0,c.heartbeat)(e,o)}e.onmessage=function(e){var o;null==r||r(),t.current.onMessage&&t.current.onMessage(e),"function"==typeof t.current.filter&&!0!==t.current.filter(e)||t.current.heartbeat&&"boolean"!=typeof t.current.heartbeat&&(null===(o=t.current.heartbeat)||void 0===o?void 0:o.returnMessage)===e.data||n(e)}}(e,n,v),function(e,t,n,r){e.onopen=function(e){t.current.onOpen&&t.current.onOpen(e),r.current=0,n(a.ReadyState.OPEN)}}(e,n,S,i),d=function(e,t,n,r,o){return a.isEventSourceSupported&&e instanceof EventSource?function(){}:((0,s.assertIsWebSocket)(e,t.current.skipAssert),e.onclose=function(e){var s;if(t.current.onClose&&t.current.onClose(e),n(a.ReadyState.CLOSED),t.current.shouldReconnect&&t.current.shouldReconnect(e)){var u=null!==(s=t.current.reconnectAttempts)&&void 0!==s?s:a.DEFAULT_RECONNECT_LIMIT;if(o.current<u){var i="function"==typeof t.current.reconnectInterval?t.current.reconnectInterval(o.current):t.current.reconnectInterval;c=window.setTimeout((function(){o.current++,r()}),null!=i?i:a.DEFAULT_RECONNECT_INTERVAL_MS)}else t.current.onReconnectStop&&t.current.onReconnectStop(u),console.warn("Max reconnect attempts of ".concat(u," exceeded"))}},function(){return c&&window.clearTimeout(c)});var c}(e,n,S,u,i),p=function(e,t,n,o,c){var s;return e.onerror=function(u){var i;if(t.current.onError&&t.current.onError(u),a.isEventSourceSupported&&e instanceof EventSource&&(t.current.onClose&&t.current.onClose(r(r({},u),{code:1006,reason:"An error occurred with the EventSource: ".concat(u),wasClean:!1})),n(a.ReadyState.CLOSED),e.close()),t.current.retryOnError)if(c.current<(null!==(i=t.current.reconnectAttempts)&&void 0!==i?i:a.DEFAULT_RECONNECT_LIMIT)){var l="function"==typeof t.current.reconnectInterval?t.current.reconnectInterval(c.current):t.current.reconnectInterval;s=window.setTimeout((function(){c.current++,o()}),null!=l?l:a.DEFAULT_RECONNECT_INTERVAL_MS)}else t.current.onReconnectStop&&t.current.onReconnectStop(t.current.reconnectAttempts),console.warn("Max reconnect attempts of ".concat(t.current.reconnectAttempts," exceeded"))},function(){return s&&window.clearTimeout(s)}}(e,n,S,u,i),function(){S(a.ReadyState.CLOSING),d(),p(),e.close(),f&&clearInterval(f)}}},7678:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.attachSharedListeners=void 0;var o=n(4401),c=n(1581),a=n(4480),s=n(1787),u=n(4203);t.attachSharedListeners=function(e,t,n,i){var l;return n.current.fromSocketIO&&(l=(0,s.setUpSocketIOPing)(i)),function(e,t,n){var r;n&&e instanceof WebSocket&&(r=(0,u.heartbeat)(e,"boolean"==typeof n?void 0:n)),e.onmessage=function(e){null==r||r(),(0,a.getSubscribers)(t).forEach((function(t){t.optionsRef.current.onMessage&&t.optionsRef.current.onMessage(e),"function"==typeof t.optionsRef.current.filter&&!0!==t.optionsRef.current.filter(e)||n&&"boolean"!=typeof n&&(null==n?void 0:n.returnMessage)===e.data||t.setLastMessage(e)}))}}(e,t,n.current.heartbeat),function(e,t){e instanceof WebSocket&&(e.onclose=function(e){(0,a.getSubscribers)(t).forEach((function(t){t.optionsRef.current.onClose&&t.optionsRef.current.onClose(e),t.setReadyState(c.ReadyState.CLOSED)})),delete o.sharedWebSockets[t],(0,a.getSubscribers)(t).forEach((function(t){var n;if(t.optionsRef.current.shouldReconnect&&t.optionsRef.current.shouldReconnect(e)){var r=null!==(n=t.optionsRef.current.reconnectAttempts)&&void 0!==n?n:c.DEFAULT_RECONNECT_LIMIT;if(t.reconnectCount.current<r){var o="function"==typeof t.optionsRef.current.reconnectInterval?t.optionsRef.current.reconnectInterval(t.reconnectCount.current):t.optionsRef.current.reconnectInterval;setTimeout((function(){t.reconnectCount.current++,t.reconnect.current()}),null!=o?o:c.DEFAULT_RECONNECT_INTERVAL_MS)}else t.optionsRef.current.onReconnectStop&&t.optionsRef.current.onReconnectStop(t.optionsRef.current.reconnectAttempts),console.warn("Max reconnect attempts of ".concat(r," exceeded"))}}))})}(e,t),function(e,t){e.onopen=function(e){(0,a.getSubscribers)(t).forEach((function(t){t.reconnectCount.current=0,t.optionsRef.current.onOpen&&t.optionsRef.current.onOpen(e),t.setReadyState(c.ReadyState.OPEN)}))}}(e,t),function(e,t){e.onerror=function(n){(0,a.getSubscribers)(t).forEach((function(t){t.optionsRef.current.onError&&t.optionsRef.current.onError(n),c.isEventSourceSupported&&e instanceof EventSource&&(t.optionsRef.current.onClose&&t.optionsRef.current.onClose(r(r({},n),{code:1006,reason:"An error occurred with the EventSource: ".concat(n),wasClean:!1})),t.setReadyState(c.ReadyState.CLOSED))})),c.isEventSourceSupported&&e instanceof EventSource&&e.close()}}(e,t),function(){l&&clearInterval(l)}}},1581:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isEventSourceSupported=t.isReactNative=t.ReadyState=t.DEFAULT_HEARTBEAT=t.UNPARSABLE_JSON_OBJECT=t.DEFAULT_RECONNECT_INTERVAL_MS=t.DEFAULT_RECONNECT_LIMIT=t.SOCKET_IO_PING_CODE=t.SOCKET_IO_PATH=t.SOCKET_IO_PING_INTERVAL=t.DEFAULT_EVENT_SOURCE_OPTIONS=t.EMPTY_EVENT_HANDLERS=t.DEFAULT_OPTIONS=void 0,t.DEFAULT_OPTIONS={},t.EMPTY_EVENT_HANDLERS={},t.DEFAULT_EVENT_SOURCE_OPTIONS={withCredentials:!1,events:t.EMPTY_EVENT_HANDLERS},t.SOCKET_IO_PING_INTERVAL=25e3,t.SOCKET_IO_PATH="/socket.io/?EIO=3&transport=websocket",t.SOCKET_IO_PING_CODE="2",t.DEFAULT_RECONNECT_LIMIT=20,t.DEFAULT_RECONNECT_INTERVAL_MS=5e3,t.UNPARSABLE_JSON_OBJECT={},t.DEFAULT_HEARTBEAT={message:"ping",timeout:6e4,interval:25e3},(n=t.ReadyState||(t.ReadyState={}))[n.UNINSTANTIATED=-1]="UNINSTANTIATED",n[n.CONNECTING=0]="CONNECTING",n[n.OPEN=1]="OPEN",n[n.CLOSING=2]="CLOSING",n[n.CLOSED=3]="CLOSED",t.isReactNative="undefined"!=typeof navigator&&"ReactNative"===navigator.product,t.isEventSourceSupported=!t.isReactNative&&function(){try{return"EventSource"in globalThis}catch(e){return!1}}()},3758:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createOrJoinSocket=void 0;var r=n(4401),o=n(1581),c=n(3682),a=n(7678),s=n(4480);t.createOrJoinSocket=function(e,t,n,u,i,l,f,d){if(!o.isEventSourceSupported&&u.current.eventSourceOptions)throw o.isReactNative?new Error("EventSource is not supported in ReactNative"):new Error("EventSource is not supported");if(u.current.share){var p=null;void 0===r.sharedWebSockets[t]?(r.sharedWebSockets[t]=u.current.eventSourceOptions?new EventSource(t,u.current.eventSourceOptions):new WebSocket(t,u.current.protocols),e.current=r.sharedWebSockets[t],n(o.ReadyState.CONNECTING),p=(0,a.attachSharedListeners)(r.sharedWebSockets[t],t,u,d)):(e.current=r.sharedWebSockets[t],n(r.sharedWebSockets[t].readyState));var v={setLastMessage:i,setReadyState:n,optionsRef:u,reconnectCount:f,reconnect:l};return(0,s.addSubscriber)(t,v),function(e,t,n,c,a){return function(){if((0,s.removeSubscriber)(e,t),!(0,s.hasSubscribers)(e)){try{var u=r.sharedWebSockets[e];u instanceof WebSocket&&(u.onclose=function(e){n.current.onClose&&n.current.onClose(e),c(o.ReadyState.CLOSED)}),u.close()}catch(e){}a&&a(),delete r.sharedWebSockets[e]}}}(t,v,u,n,p)}if(e.current=u.current.eventSourceOptions?new EventSource(t,u.current.eventSourceOptions):new WebSocket(t,u.current.protocols),n(o.ReadyState.CONNECTING),!e.current)throw new Error("WebSocket failed to be created");return(0,c.attachListeners)(e.current,{setLastMessage:i,setReadyState:n},u,l.current,f,d)}},6974:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function a(e){try{u(r.next(e))}catch(e){c(e)}}function s(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,c,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return c={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function s(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getUrl=void 0;var c=n(1787);t.getUrl=function(e,t){return r(void 0,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return"function"!=typeof e?[3,2]:[4,e()];case 1:return n=o.sent(),[3,3];case 2:n=e,o.label=3;case 3:return r=t.current.fromSocketIO?(0,c.parseSocketIOUrl)(n):n,[2,t.current.queryParams?(0,c.appendQueryParams)(r,t.current.queryParams):r]}}))}))}},4401:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetWebSockets=t.sharedWebSockets=void 0,t.sharedWebSockets={},t.resetWebSockets=function(e){if(e&&t.sharedWebSockets.hasOwnProperty(e))delete t.sharedWebSockets[e];else for(var n in t.sharedWebSockets)t.sharedWebSockets.hasOwnProperty(n)&&delete t.sharedWebSockets[n]}},4203:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.heartbeat=void 0;var r=n(1581);t.heartbeat=function(e,t){var n=t||{},o=n.interval,c=void 0===o?r.DEFAULT_HEARTBEAT.interval:o,a=n.timeout,s=void 0===a?r.DEFAULT_HEARTBEAT.timeout:a,u=n.message,i=void 0===u?r.DEFAULT_HEARTBEAT.message:u,l=!1,f=setInterval((function(){try{e.send(i)}catch(e){}}),c),d=setInterval((function(){l?l=!1:e.close()}),s);return e.addEventListener("close",(function(){clearInterval(f),clearInterval(d)})),function(){l=!0}}},4480:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetSubscribers=t.removeSubscriber=t.addSubscriber=t.hasSubscribers=t.getSubscribers=void 0;var n={},r=[];t.getSubscribers=function(e){return(0,t.hasSubscribers)(e)?Array.from(n[e]):r},t.hasSubscribers=function(e){var t;return(null===(t=n[e])||void 0===t?void 0:t.size)>0},t.addSubscriber=function(e,t){n[e]=n[e]||new Set,n[e].add(t)},t.removeSubscriber=function(e,t){n[e].delete(t)},t.resetSubscribers=function(e){if(e&&n.hasOwnProperty(e))delete n[e];else for(var t in n)n.hasOwnProperty(t)&&delete n[t]}},4387:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.websocketWrapper=void 0,t.websocketWrapper=function(e,t){return new Proxy(e,{get:function(e,n){var r=e[n];return"reconnect"===n?t:"function"==typeof r?(console.error("Calling methods directly on the websocket is not supported at this moment. You must use the methods returned by useWebSocket."),function(){}):r},set:function(e,t,n){return/^on/.test(t)?(console.warn("The websocket's event handlers should be defined through the options object passed into useWebSocket."),!1):(e[t]=n,!0)}})},t.default=t.websocketWrapper},1787:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setUpSocketIOPing=t.appendQueryParams=t.parseSocketIOUrl=void 0;var r=n(1581);t.parseSocketIOUrl=function(e){if(e){var t=/^https|wss/.test(e),n=e.replace(/^(https?|wss?)(:\/\/)?/,"").replace(/\/$/,"");return"".concat(o=t?"wss":"ws","://").concat(n).concat(r.SOCKET_IO_PATH)}if(""===e){var o=(t=/^https/.test(window.location.protocol))?"wss":"ws",c=window.location.port?":".concat(window.location.port):"";return"".concat(o,"://").concat(window.location.hostname).concat(c).concat(r.SOCKET_IO_PATH)}return e},t.appendQueryParams=function(e,t){void 0===t&&(t={});var n=/\?([\w]+=[\w]+)/.test(e),r="".concat(Object.entries(t).reduce((function(e,t){var n=t[0],r=t[1];return e+"".concat(n,"=").concat(r,"&")}),"").slice(0,-1));return"".concat(e).concat(n?"&":"?").concat(r)},t.setUpSocketIOPing=function(e,t){return void 0===t&&(t=r.SOCKET_IO_PING_INTERVAL),window.setInterval((function(){return e(r.SOCKET_IO_PING_CODE)}),t)}},9448:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.useEventSource=void 0;var c=n(7294),a=n(1835),s=n(1581);t.useEventSource=function(e,t,n){void 0===t&&(t=s.DEFAULT_EVENT_SOURCE_OPTIONS);var u=t.withCredentials,i=t.events,l=o(t,["withCredentials","events"]);void 0===n&&(n=!0);var f=r(r({},l),{eventSourceOptions:{withCredentials:u}}),d=(0,c.useRef)(s.EMPTY_EVENT_HANDLERS);i&&(d.current=i);var p=(0,a.useWebSocket)(e,f,n),v=p.lastMessage,S=p.readyState,b=p.getWebSocket;return(0,c.useEffect)((function(){(null==v?void 0:v.type)&&Object.entries(d.current).forEach((function(e){var t=e[0],n=e[1];t===v.type&&n(v)}))}),[v]),{lastEvent:v,readyState:S,getEventSource:b}}},6548:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.useSocketIO=void 0;var o=n(7294),c=n(1835),a=n(1581),s={type:"empty",payload:null};t.useSocketIO=function(e,t,n){void 0===t&&(t=a.DEFAULT_OPTIONS),void 0===n&&(n=!0);var u=(0,o.useMemo)((function(){return r(r({},t),{fromSocketIO:!0})}),[]),i=(0,c.useWebSocket)(e,u,n),l=i.sendMessage,f=i.sendJsonMessage,d=i.lastMessage,p=i.readyState,v=i.getWebSocket,S=(0,o.useMemo)((function(){return function(e){if(!e||!e.data)return s;var t=e.data.match(/\[.*]/);if(!t)return s;var n=JSON.parse(t);return Array.isArray(n)&&n[1]?{type:n[0],payload:n[1]}:s}(d)}),[d]);return{sendMessage:l,sendJsonMessage:f,lastMessage:S,lastJsonMessage:S,readyState:p,getWebSocket:v}}},1835:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function a(e){try{u(r.next(e))}catch(e){c(e)}}function s(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,c,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return c={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function s(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useWebSocket=void 0;var s=n(7294),u=n(3935),i=n(1581),l=n(3758),f=n(6974),d=a(n(4387)),p=n(9885);t.useWebSocket=function(e,t,n){void 0===t&&(t=i.DEFAULT_OPTIONS),void 0===n&&(n=!0);var a=(0,s.useState)(null),v=a[0],S=a[1],b=(0,s.useState)({}),h=b[0],E=b[1],O=(0,s.useMemo)((function(){if(v)try{return JSON.parse(v.data)}catch(e){return i.UNPARSABLE_JSON_OBJECT}return null}),[v]),y=(0,s.useRef)(null),_=(0,s.useRef)(null),g=(0,s.useRef)((function(){})),T=(0,s.useRef)(0),w=(0,s.useRef)([]),N=(0,s.useRef)(null),m=(0,s.useRef)(t);m.current=t;var R=y.current&&void 0!==h[y.current]?h[y.current]:null!==e&&!0===n?i.ReadyState.CONNECTING:i.ReadyState.UNINSTANTIATED,I=t.queryParams?JSON.stringify(t.queryParams):null,C=(0,s.useCallback)((function(e,t){var n;void 0===t&&(t=!0),i.isEventSourceSupported&&_.current instanceof EventSource?console.warn("Unable to send a message from an eventSource"):(null===(n=_.current)||void 0===n?void 0:n.readyState)===i.ReadyState.OPEN?((0,p.assertIsWebSocket)(_.current,m.current.skipAssert),_.current.send(e)):t&&w.current.push(e)}),[]),k=(0,s.useCallback)((function(e,t){void 0===t&&(t=!0),C(JSON.stringify(e),t)}),[C]),P=(0,s.useCallback)((function(){return!0!==m.current.share||i.isEventSourceSupported&&_.current instanceof EventSource?_.current:(null===N.current&&_.current&&((0,p.assertIsWebSocket)(_.current,m.current.skipAssert),N.current=(0,d.default)(_.current,g)),N.current)}),[]);return(0,s.useEffect)((function(){if(null!==e&&!0===n){var t,a=!1,s=!0,d=function(){return o(void 0,void 0,void 0,(function(){var n,o,i;return c(this,(function(c){switch(c.label){case 0:return n=y,[4,(0,f.getUrl)(e,m)];case 1:return n.current=c.sent(),o=function(e){a||(0,u.flushSync)((function(){return S(e)}))},i=function(e){a||(0,u.flushSync)((function(){return E((function(t){var n;return r(r({},t),y.current&&((n={})[y.current]=e,n))}))}))},s&&(t=(0,l.createOrJoinSocket)(_,y.current,i,m,o,g,T,C)),[2]}}))}))};return g.current=function(){a||(N.current&&(N.current=null),null==t||t(),d())},d(),function(){a=!0,s=!1,N.current&&(N.current=null),null==t||t(),S(null)}}null!==e&&!1!==n||(T.current=0,E((function(e){var t;return r(r({},e),y.current&&((t={})[y.current]=i.ReadyState.CLOSED,t))})))}),[e,n,I,C]),(0,s.useEffect)((function(){R===i.ReadyState.OPEN&&w.current.splice(0).forEach((function(e){C(e)}))}),[R]),{sendMessage:C,sendJsonMessage:k,lastMessage:v,lastJsonMessage:O,readyState:R,getWebSocket:P}}},9885:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetGlobalState=t.assertIsWebSocket=void 0;var r=n(4401),o=n(4480);t.assertIsWebSocket=function(e,t){if(!t&&e instanceof WebSocket==0)throw new Error("")},t.resetGlobalState=function(e){(0,o.resetSubscribers)(e),(0,r.resetWebSockets)(e)}}}]);